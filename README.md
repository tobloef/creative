### Look at the code at you own risk, it's deliberately a mess.